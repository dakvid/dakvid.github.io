---
title: "W[h]ither Local Democracy?"
date: "14 October 2016"
---

If you live in New Zealand you would have been hard pressed not to notice that we had
local body elections recently. It seems that all anyone can talk about is the turnout.
Is it all bad news?

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(warning = FALSE)
library(readr)
library(rvest)
library(magrittr)
library(tidyr)
library(dplyr)
library(purrr)
library(plotly)
```

### Turnout

```{r get_turnout_data}
if(!file.exists("data/local2016/summary_turnout.csv") |
   !file.exists("data/local2016/council_turnout.csv")) {
  lg_tables <- 
    read_html("http://www.lgnz.co.nz/vote2016/preliminary-voter-turnout-2016/") %>% 
    html_nodes("table") %>% 
    map(html_table, header = TRUE)
  # Combine national and council type
  summary_turnout <- 
    bind_rows(
      lg_tables %>% 
        extract2(1) %>% 
        select(2:4) %>% 
        set_names(c(2010, 2013, 2016)) %>% 
        gather(Year, Turnout) %>% 
        mutate(Group = "National"),
      lg_tables %>% 
        extract2(2) %>% 
        select(1:4) %>% 
        set_names(c("Group", 2010, 2013, 2016)) %>% 
        gather(Year, Turnout, -Group)
    )
    write_csv(summary_turnout, "data/local2016/summary_turnout.csv")

    council_turnout <- 
      bind_rows(
        lg_tables %>% 
          extract2(3) %>% 
          select(1:4) %>% 
          set_names(c("Council", 2010, 2013, 2016)) %>% 
          mutate(Type = "Metro") %>% 
          gather(Year, Turnout, -Council, -Type),
        lg_tables %>% 
          extract2(4) %>% 
          select(1:4) %>% 
          set_names(c("Council", 2010, 2013, 2016)) %>% 
          mutate(Type = "Provincial") %>% 
          gather(Year, Turnout, -Council, -Type),
        lg_tables %>% 
          extract2(5) %>% 
          select(1:4) %>% 
          set_names(c("Council", 2010, 2013, 2016)) %>% 
          mutate(Type = "Rural") %>% 
          gather(Year, Turnout, -Council, -Type)
      ) %>% 
      filter(Council != "Total") %>% 
      mutate(Council = sub("*", "", Council, fixed = TRUE),
             Council = gsub(intToUtf8(160), "", Council),
             Turnout = Turnout %>% gsub(intToUtf8(160), "", .) %>% as.numeric())
    write_csv(council_turnout, "data/local2016/council_turnout.csv")
} else {
  summary_turnout <- read_csv("data/local2016/summary_turnout.csv")
  council_turnout <- read_csv("data/local2016/council_turnout.csv")
}
```

There has been a lot of talk about the very low voter turnout for local body versus
general elections. In fact, it has been argued as a reason for trying online voting.
(These arguments are flawed though --- online voting would be a Bad Idea.^[This is
where I get to say "trust me, I'm a doctor (of verifying computer systems)". But if that's
not enough, [here are some of the important points](http://thespinoff.co.nz/featured/15-09-2015/politics-the-myths-of-online-voting/).])

These elections haven't been much better than last time.
Here's a graph comparing the turnouts of the last three elections, both nationally and
grouping the councils as "metro", "provincial" and "rural".

```{r turnout_summary, fig.height=2}
nto <- 
  summary_turnout %>% 
  spread(Year, Turnout) %>% 
  mutate(min_to = pmin(`2010`, `2013`, `2016`),
         max_to = pmax(`2010`, `2013`, `2016`))
plot_ly(nto,
        color = I("gray80")) %>% 
  add_segments(x = ~min_to, xend = ~max_to, y = ~Group, yend = ~Group, showlegend = FALSE) %>% 
  add_markers(x = ~`2010`, y = ~Group, name = "2010", color = I("yellow")) %>% 
  add_markers(x = ~`2013`, y = ~Group, name = "2013", color = I("blue")) %>% 
  add_markers(x = ~`2016`, y = ~Group, name = "2016", color = I("red")) %>% 
  layout(
    title = "Local Election Turnout in New Zealand",
    xaxis = list(title = "Voter Turnout (Percent)"),
    yaxis = list(title = "")#,
    #margin = list(l = 140)
  )
```

You can see that there was a reasonable drop between 2010 and 2013, and a slight overall increase this year.
This increase has only been in the big cities though --- the provincial and rural areas have continued
to fall, though they are still higher.
I say "only", but the metro areas account for nearly two thirds of the country (62% in 2013).

Are the changes uniform across these groups? Let's look in more detail at the individual council turnouts.
This graph is grouped by metro, provincial and rural, then ordered by 2013 turnout.

```{r turnout_dumbbell0, fig.height=12}
cto0 <- 
  council_turnout %>% 
  spread(Year, Turnout) %>% 
  mutate(min_to = pmin(`2010`, `2013`, `2016`),
         max_to = pmax(`2010`, `2013`, `2016`))
cto0$Council <- 
  factor(cto0$Council,
         levels = cto0$Council[order(cto0$Type, cto0$`2013`, method = "radix", decreasing = c(TRUE, FALSE))])
plot_ly(cto0,
        color = I("gray80")) %>% 
  add_segments(x = ~min_to, xend = ~max_to, y = ~Council, yend = ~Council, showlegend = FALSE) %>% 
  add_markers(x = ~`2010`, y = ~Council, name = "2010", color = I("yellow")) %>% 
  add_markers(x = ~`2013`, y = ~Council, name = "2013", color = I("blue")) %>% 
  add_markers(x = ~`2016`, y = ~Council, name = "2016", color = I("red")) %>% 
  layout(
    title = "Local Election Turnout in New Zealand",
    xaxis = list(title = "Voter Turnout (Percent)"),
    yaxis = list(title = ""),
    margin = list(l = 180)
  )
```

First, congratulations to Nelson for the best consistency (52.2%, 52.2%, 52.1%)!
Overall, the general trends are followed, but there's a lot of individual variation.
Matamata-Piako and Otorohanga^[I wonder if having [a killer on the loose](http://www.nzherald.co.nz/kirsty-johnston/news/article.cfm?a_id=980&objectid=11725688)
in the final week had an effect.]
are pretty impressive drops, but they're not large populations.
There are a few areas --- eg Wellington, Queenstown-Lakes, Waitomo --- where they've just had their
best turnout in six years.

Some are unavoidably idiosyncratic --- Chatham Islands only has a population of 650, so it's not surprising
to see wild percentage swings --- but it would be interesting to know how much of the differences were
due to local get-out-the-vote strategies vs passions for local issues/people vs natural variation.


#### Slopegraph

Initially, I was planning on producing slopegraphs of this data, but ended up going with the dumbbell
plots. Mostly it was for clarity --- the slopegraph was very cluttered with all the councils, and
the dumbbell seems to provide a clearer comparison even with such a large list.
Also it was partly due to the difficulty of producing a slopegraph. I had figured that there would
be a package for it by now, but the two that I tried^[[slopegraph](https://github.com/leeper/slopegraph)
and [toaster](https://github.com/teradata-aster-field/toaster)]
didn't work.

### Council Websites

I must say that I'm in agreement with [Caleb Tutty](https://twitter.com/Caleb_T/status/784559650083631105) --- 
it would be great if there was a central agency
in charge of the standards and reporting for local election results.
I had quite mixed results visiting the various council websites trying to find and retrieve
what I wanted.

#### Availability

The most obvious issue is simply availability of data. Most (but not all) councils were good at having the
election page and/or results page prominently linked from their homepage.
One (I forget which) had one election page with few details and no hint that there was another
more detailed page that contained results on it.

Some councils provided fantastic daily return stats (this was a postal election, running over three weeks)
with comparable figures from the previous one or two elections. Many didn't. And some (I think, but didn't take
notes to be certain) had these up during the election but then took them down when results were posted.
Some reported the overall turnout with the candidate results but some didn't.

Nobody linked to the [Local Government NZ](http://www.lgnz.co.nz/vote2016/preliminary-voter-turnout-2016/)
website that contained the complete results I finally used. I accidentally discovered this in a
Google search. After I'd spent a reasonable amount of time manually compiling incomplete data from
each council's webpage and [DIA's 2013 report](http://www.dia.govt.nz/Services-Local-Elections-Index).

#### Formats

Unfortunately the best consistency around the format for data was PDF. I recall exactly one council
with Excel. There might have been a couple with text (HTML) in their website, but everyone else just
had PDF. This makes it virtually impossible to extract data without manually retyping it.
I can understand (even though it's 2016) that they might not be expecting people like me to want
to play around with the data like this, but surely they should be aware that national media would
want to collate and report on it all?

Many of the councils contracted their election work to Electionz;
their [results](http://www.electionz.com/2016lgeresults/2016_results.htm) were all in PDF.
They did provide their [returns data](http://www.electionz.com/2016lgereturns/2016_returns.htm)
as HTML, but it was a little tricky to pull apart with rvest. (I'm sure I would have gotten
there eventually, but I put it off and luckily found a better source.) If they could provide
multiple formats next time that would be a huge improvement.

I have to give a special mention to the MacKenzie District Council. Electionz produced a PDF of
the results, but the council decided to post PNG screenshots of it on their website instead.
If you're blind and live in the MacKenzie District, your council thinks you don't care about
knowing what happened to your vote.

The difficulty with extracting information meant that at least one of the things I wanted
to try out --- comparing daily returns across councils and years --- wasn't practical to
look at in the small amount of time I had available.

#### Graphs

Mostly, councils just reported the data (if that). A couple were tempted to provide graphs too.

New Plymouth had a graph of daily returns, but didn't provide the raw data, so that wasn't
especially useful.

Whanganui had several graphs which were going to be "updated daily". Except they weren't updated
at all in the last week of the campaign.

I think the first priority is to provide the data in a machine-readable format, as well as
human-readable. If graphs are provided in addition it doesn't hurt (though keep updating
them if you say you will!), but I would be inclined to leave it to the
[experts](http://insights.nzherald.co.nz/article/local-elections-2016).

