<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="date" content="2016-08-14" />

<title>Unfamiliar Maps</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/htmlwidgets-0.7/htmlwidgets.js"></script>
<link href="site_libs/leaflet-0.7.3/leaflet.css" rel="stylesheet" />
<script src="site_libs/leaflet-0.7.3/leaflet.js"></script>
<link href="site_libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<link href="site_libs/leaflet-label-0.2.2/leaflet.label.css" rel="stylesheet" />
<script src="site_libs/leaflet-label-0.2.2/leaflet.label.js"></script>
<script src="site_libs/leaflet-binding-1.0.1.9004/leaflet.js"></script>
<script src="site_libs/leaflet-providers-1.0.27/leaflet-providers.js"></script>
<script src="site_libs/leaflet-providers-plugin-1.0.1.9004/leaflet-providers-plugin.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<link rel="alternate" type="application/rss+xml" title="David's AdVentures In Data" href="/feed.xml">

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">David's AdVentures In Data</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-newspaper-o"></span>
     
    Posts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="2016-10-whither-local_democracy.html">W[h]ither Local Democracy?</a>
    </li>
    <li>
      <a href="2016-08-the-luminaries.html">The Luminaries</a>
    </li>
    <li>
      <a href="2016-08-unfamiliar-maps.html">Unfamiliar Maps</a>
    </li>
    <li>
      <a href="2016-08-birthday-eve.html">Birthday Eve</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">
        <span class="fa fa-question"></span>
         
        About Site
      </a>
    </li>
    <li>
      <a href="https://twitter.com/dakvid">
        <span class="fa fa-twitter"></span>
         
        Twitter
      </a>
    </li>
    <li>
      <a href="https://nz.linkedin.com/in/dfriggens">
        <span class="fa fa-linkedin"></span>
         
        LinkedIn
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="feed.xml">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Unfamiliar Maps</h1>
<h4 class="date"><em>14 August 2016</em></h4>

</div>


<p>At least 3 people have booked flights to Sydney, Nova Scotia (population 30,000) intending to holiday in New South Wales (two orders of magnitude larger). There are a number of cases like this of towns and cities with larger and more well known doppelgangers. I thought it would be interesting to have a map that labelled the familiar names in the unfamiliar locations.</p>
<p>This is fairly easy to do in R, given the data that comes with the <code>maps</code> package. But bear in mind that the data is neither 100% accurate nor complete. Also, it was a mostly manual selection of what to include, based on my interpretations of what is interesting and well known. Feel free to make your own version, based on your knowledge and familiarity of the globe.</p>
<pre class="r"><code>library(maps)
library(leaflet)
library(dplyr)
library(purrr)
data(&quot;world.cities&quot;)

# Manually prepared file giving name and region, and when ordered by population,
# how many of the largest are &quot;familiar&quot; and how many of the smallest are &quot;unfamiliar&quot;
my_cities &lt;- readr::read_csv(&quot;data/familiar_cities.csv&quot;)

familiar &lt;- 
  my_cities %&gt;%
  inner_join(world.cities) %&gt;% 
  group_by(name) %&gt;% 
  mutate(rank_desc = rank(-pop)) %&gt;% 
  filter(rank_desc &lt;= num_familiar) %&gt;% 
  ungroup() %&gt;% 
  select(-num_familiar, -num_unfamiliar, -rank_desc)

unfamiliar &lt;- 
  my_cities %&gt;%
  inner_join(world.cities) %&gt;% 
  group_by(name) %&gt;% 
  mutate(rank_asc = rank(pop)) %&gt;% 
  filter(rank_asc &lt;= num_unfamiliar) %&gt;% 
  ungroup() %&gt;% 
  select(-num_familiar, -num_unfamiliar, -rank_asc)</code></pre>
<p>We can add labels to the map using the latest version of the <code>leaflet</code> package. I had to install from Github - the CRAN version (1.0.1) doesn’t support this. The cities are grouped by the continental region of the (main) familiar city.</p>
<pre class="r"><code>leaflet(width = &quot;100%&quot;) %&gt;% 
  addProviderTiles(&quot;Esri.WorldGrayCanvas&quot;) %&gt;% 
  addCircleMarkers(
    data = familiar %&gt;% filter(region == &quot;Americas&quot;),
    group = &quot;Americas - Familiar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;red&quot;,
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addCircleMarkers(
    data = unfamiliar %&gt;% filter(region == &quot;Americas&quot;),
    group = &quot;Americas - Unfamiliar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;navy&quot;,
    options = markerOptions(riseOnHover = TRUE),
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addCircleMarkers(
    data = familiar %&gt;% filter(region == &quot;Asia-Pacific&quot;),
    group = &quot;Asia/Pacific - Familiar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;red&quot;,
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addCircleMarkers(
    data = unfamiliar %&gt;% filter(region == &quot;Asia-Pacific&quot;),
    group = &quot;Asia/Pacific - Unfamiliar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;navy&quot;,
    options = markerOptions(riseOnHover = TRUE),
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addCircleMarkers(
    data = familiar %&gt;% filter(region == &quot;Europe-Africa&quot;),
    group = &quot;Europe/Africa - Familiar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;red&quot;,
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addCircleMarkers(
    data = unfamiliar %&gt;% filter(region == &quot;Europe-Africa&quot;),
    group = &quot;Europe/Africa - Unfamiliar&quot;,
    radius = 6,
    stroke = FALSE,
    fillOpacity = 0.5,
    color = &quot;navy&quot;,
    options = markerOptions(riseOnHover = TRUE),
    label = ~name,
    labelOptions = labelOptions(noHide = T)) %&gt;% 
  addLayersControl(
    overlayGroups = c(&quot;Americas - Familiar&quot;, &quot;Americas - Unfamiliar&quot;,
                      &quot;Asia/Pacific - Familiar&quot;, &quot;Asia/Pacific - Unfamiliar&quot;,
                      &quot;Europe/Africa - Familiar&quot;, &quot;Europe/Africa - Unfamiliar&quot;),
    options = layersControlOptions(collapsed = FALSE)) %&gt;% 
  hideGroup(&quot;Americas - Familiar&quot;) %&gt;%
  hideGroup(&quot;Asia/Pacific - Familiar&quot;) %&gt;% 
  hideGroup(&quot;Europe/Africa - Familiar&quot;)</code></pre>
<div id="htmlwidget-6153da3cefbf8fe60ef0" style="width:100%;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-6153da3cefbf8fe60ef0">{"x":{"calls":[{"method":"addProviderTiles","args":["Esri.WorldGrayCanvas",null,null,{"errorTileUrl":"","noWrap":false,"zIndex":null,"unloadInvisibleTiles":null,"updateWhenIdle":null,"detectRetina":false,"reuseTiles":false}]},{"method":"addCircleMarkers","args":[[42.34,32.79,27.71,32.79,31.85,36.78,29.77,30.33,17.99,36.21,-12.07,34.11,32.81,49.28],[-71.02,-79.99,-97.29,-96.77,-106.44,-119.79,-95.39,-81.66,-76.8,-115.22,-77.05,-118.41,-117.14,-123.13],6,null,"Americas - Familiar",{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":false,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.5,"dashArray":null},null,null,null,["Boston","Charleston","Corpus Christi","Dallas","El Paso","Fresno","Houston","Jacksonville","Kingston","Las Vegas","Lima","Los Angeles","San Diego","Vancouver"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addCircleMarkers","args":[[52.99,38.35,-24.03,50.66,9.66,28.65,5.16,54.4,34.76,44.23,-29.03,15.02,-23.89,40.74,-37.46,10.33,9.9,14.78,14.05,45.63],[-0.02,-81.63,-54.83,-120.46,-73.75,-17.87,-75.04,-126.65,-77.4,-76.5,168.05,-87.45,-56.5,-84.11,-72.36,-73.19,-84,-89.78,-86.47,-122.64],6,null,"Americas - Unfamiliar",{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":true,"riseOffset":250,"stroke":false,"color":"navy","weight":5,"opacity.1":0.5,"fill":true,"fillColor":"navy","fillOpacity":0.5,"dashArray":null},null,null,null,["Boston","Charleston","Corpus Christi","Dallas","El Paso","El Paso","Fresno","Houston","Jacksonville","Kingston","Kingston","Las Vegas","Lima","Lima","Los Angeles","San Diego","San Diego","San Diego","San Diego","Vancouver"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addCircleMarkers","args":[[-34.93,18.96,-43.53,6.93,28.67,25.3,34.53,-37.81,-31.96,38.26,-33.87,-41.28],[138.6,72.82,172.64,79.85,77.21,51.51,69.17,144.96,115.84,140.89,151.21,174.78],6,null,"Asia/Pacific - Familiar",{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":false,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.5,"dashArray":null},null,null,null,["Adelaide","Bombay","Christchurch","Colombo","Delhi","Doha","Kabul","Melbourne","Perth","Sendai","Sydney","Wellington"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addCircleMarkers","args":[[-32.7,-37.17,50.73,-25.29,42.85,29.32,32.87,28.11,44.88,56.4,31.82,46.15,-32.56,43.95,52.7,26.66],[26.29,174.98,-1.76,-49.24,-80.5,47.82,35.22,-80.64,-76.23,-3.47,130.29,-60.17,148.95,-77.35,-2.52,-80.25],6,null,"Asia/Pacific - Unfamiliar",{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":true,"riseOffset":250,"stroke":false,"color":"navy","weight":5,"opacity.1":0.5,"fill":true,"fillColor":"navy","fillOpacity":0.5,"dashArray":null},null,null,null,["Adelaide","Bombay","Christchurch","Colombo","Delhi","Doha","Kabul","Melbourne","Perth","Perth","Sendai","Sydney","Wellington","Wellington","Wellington","Wellington"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addCircleMarkers","args":[[41.4,51.39,54.6,52.52,52.48,53.8,50.83,51.46,50.83,52.21,42.38,51.88,51.05,53.33,56.47,51.47,50.12,53.23,52.4,53.25,40.82,53.42,51.52,40.42,36.72,53.48,45.48,51.76,38.12,48.86,50.81,51.45,59.93,37.4,50.91,32.87,52.1],[2.17,-2.38,-5.93,13.38,-1.91,-1.75,-0.15,-2.6,4.33,0.13,-71.12,0.9,13.74,-6.25,-3,7,8.68,6.57,9.73,-0.55,-96.69,-2.99,-0.1,-3.71,-4.42,-2.25,9.19,-1.26,13.36,2.34,-1.09,-0.98,30.32,-5.98,-1.41,13.18,5.11],6,null,"Europe/Africa - Familiar",{"lineCap":null,"lineJoin":null,"clickable":true,"pointerEvents":null,"className":"","stroke":false,"color":"red","weight":5,"opacity":0.5,"fill":true,"fillColor":"red","fillOpacity":0.5,"dashArray":null},null,null,null,["Barcelona","Bath","Belfast","Berlin","Birmingham","Bradford","Brighton","Bristol","Brussels","Cambridge","Cambridge","Colchester","Dresden","Dublin","Dundee","Essen","Frankfurt","Groningen","Hanover","Lincoln","Lincoln","Liverpool","London","Madrid","Malaga","Manchester","Milan","Oxford","Palermo","Paris","Portsmouth","Reading","Saint Petersburg","Sevilla","Southampton","Tripoli","Utrecht"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addCircleMarkers","args":[[10.13,17.95,-25.68,13.5,14.83,33.53,44.12,44.03,41.68,43.75,18.32,-37.88,41.98,42.58,37.72,-28.16,51.47,52.34,5.8,44.15,-34.88,-43.65,38.89,44.03,42.97,1.99,4.74,6.72,42.98,1.35,45.73,-43.3,2.89,43.2,15.57,36.86,40.34,27.76,4.28,44.5,37.51,-27.66],[-64.72,-76.35,30.03,-88.53,-88.5,-86.8,-79.56,-77.73,-72.94,-81.25,-77.89,175.44,-82.93,-82.17,-121.91,30.23,4.47,14.53,-55.48,-81.03,-61.54,172.48,-121.3,-64.72,-81.24,157.78,-74.27,-72.74,-71.44,-75.51,-63.87,172.18,-75.44,-80.38,-61.46,-76.36,-75.93,-82.64,-75.93,-81.37,22.38,30.32],6,null,"Europe/Africa - Unfamiliar",{"clickable":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":true,"riseOffset":250,"stroke":false,"color":"navy","weight":5,"opacity.1":0.5,"fill":true,"fillColor":"navy","fillOpacity":0.5,"dashArray":null},null,null,null,["Barcelona","Bath","Belfast","Berlin","Berlin","Birmingham","Bradford","Brighton","Bristol","Brussels","Cambridge","Cambridge","Colchester","Dresden","Dublin","Dundee","Essen","Frankfurt","Groningen","Hanover","Lincoln","Lincoln","Lincoln","Liverpool","London","London","Madrid","Malaga","Manchester","Milan","Oxford","Oxford","Palermo","Paris","Portsmouth","Portsmouth","Reading","Saint Petersburg","Sevilla","Southampton","Tripoli","Utrecht"],{"clickable":false,"noHide":true,"direction":"right","opacity":1,"offset":[12,-15],"zoomAnimation":true,"className":""}]},{"method":"addLayersControl","args":[[],["Americas - Familiar","Americas - Unfamiliar","Asia/Pacific - Familiar","Asia/Pacific - Unfamiliar","Europe/Africa - Familiar","Europe/Africa - Unfamiliar"],{"collapsed":false,"autoZIndex":true,"position":"topright"}]},{"method":"hideGroup","args":["Americas - Familiar"]},{"method":"hideGroup","args":["Asia/Pacific - Familiar"]},{"method":"hideGroup","args":["Europe/Africa - Familiar"]}],"limits":{"lat":[-43.65,59.93],"lng":[-126.65,175.44]}},"evals":[],"jsHooks":[]}</script>
<div id="notes" class="section level4">
<h4>Notes</h4>
<ul>
<li>Click to expand the code in the post (if it wasn’t obvious).</li>
<li>I left out Alexandria, Buenos Aires and San Francisco as there were so many alternatives.</li>
<li>The labels on the map are a bit cluttered in places. Perhaps with more thought they could be handled better.</li>
<li>Popups with more information (population etc) would be a nice improvement, but given that the data is outdated and unreliable I opted not to.</li>
<li>The manually curated CSV file is structured as follows:</li>
</ul>
<pre class="r"><code>head(my_cities)</code></pre>
<pre><code>## # A tibble: 6 × 4
##         name num_familiar num_unfamiliar        region
##        &lt;chr&gt;        &lt;dbl&gt;          &lt;dbl&gt;         &lt;chr&gt;
## 1   Adelaide            1              1  Asia-Pacific
## 2  Barcelona            1              1 Europe-Africa
## 3       Bath            1              1 Europe-Africa
## 4    Belfast            1              1 Europe-Africa
## 5     Berlin            1              2 Europe-Africa
## 6 Birmingham            1              1 Europe-Africa</code></pre>
</div>

<hr />

<footer>
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="images/cc.png" /></a><br />This site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>


</body>
</html>
