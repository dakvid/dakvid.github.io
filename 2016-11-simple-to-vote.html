<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Simple To Vote</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/htmlwidgets-0.7/htmlwidgets.js"></script>
<link href="site_libs/plotlyjs-1.16.3/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotlyjs-1.16.3/plotly-latest.min.js"></script>
<script src="site_libs/plotly-binding-4.5.2/plotly.js"></script>
<link href="site_libs/font-awesome-4.5.0/css/font-awesome.min.css" rel="stylesheet" />
<link rel="alternate" type="application/rss+xml" title="David's AdVentures In Data" href="/feed.xml">

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">David's AdVentures In Data</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-newspaper-o"></span>
     
    Posts
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="2016-11-simple-to-vote.html">Simple To Vote</a>
    </li>
    <li>
      <a href="2016-10-whither-local-democracy.html">W[h]ither Local Democracy?</a>
    </li>
    <li>
      <a href="2016-08-the-luminaries.html">The Luminaries</a>
    </li>
    <li>
      <a href="2016-08-unfamiliar-maps.html">Unfamiliar Maps</a>
    </li>
    <li>
      <a href="2016-08-birthday-eve.html">Birthday Eve</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    About
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="about.html">
        <span class="fa fa-question"></span>
         
        About Site
      </a>
    </li>
    <li>
      <a href="https://twitter.com/dakvid">
        <span class="fa fa-twitter"></span>
         
        Twitter
      </a>
    </li>
    <li>
      <a href="https://nz.linkedin.com/in/dfriggens">
        <span class="fa fa-linkedin"></span>
         
        LinkedIn
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="feed.xml">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Simple To Vote</h1>
<h4 class="date"><em>8 November 2016</em></h4>

</div>


<p>Recently we had local body elections in New Zealand. (You may <a href="2016-10-whither-local-democracy.html">have heard</a>.) <a href="http://www.stv.govt.nz">Single Transferable Vote</a> (STV) was used for 7 of the 67 territorial authorities (city and district councils), for 1 of the 11 regional councils, and for 19 of the 20 district health boards<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>. STV is Simple To Vote, but it can also be Strenuous To Vet — understanding how the votes are counted and the results are calculated is much less intuitive than First Past the Post (FPP).</p>
<p>So here are some animations to hopefully make the process in New Zealand a little easier to understand.</p>
<div id="voting" class="section level2">
<h2>Voting</h2>
<p>Voting is pretty straightforward. Instead of picking the single candidate you prefer (or <em>n</em> candidates if there are <em>n</em> seats), you rank all of the candidates in your order of preference. In theory this is pretty simple, but it can be quite an exercise if there are a lot of candidates and you don’t know much about them (a common complaint about the district health boards).</p>
<p>One nice thing is that you don’t really need to think “strategically”. The best strategy really is to rank Person A ahead of Person B if you would prefer them to be elected, and vice versa. In comparison, with FPP (and <a href="http://www.elections.org.nz/voting-system/mmp-voting-system">MMP</a> party selection) you have to consider “wasted” votes, the threat of “<a href="https://en.wikipedia.org/wiki/Vote_splitting">splitting</a>” the vote etc. Graham Edgeler <a href="http://publicaddress.net/legalbeagle/voting-in-an-stv-election/">has a good discussion</a> of some of the facts.<a href="#fn2" class="footnoteRef" id="fnref2"><sup>2</sup></a></p>
<p>In New Zealand, unlike some other jurisdictions, we are not required to rank all candidates. A ballot only needs to have a single candidate ranked 1 to be valid. Some people just do this (at a guess, people who are used to FPP and haven’t cottoned on to STV yet); some only vote for the number of seats available. Others only vote for those they like — though there is still benefit to ranking people you dislike higher than people you despise. Another phenomenon is people ranking the tail of candidates in the order they appear on the paper — some jurisdictions randomise the ballot listing to avoid advantaging Aaron Aardvark over Ziggy Zebra.<a href="#fn3" class="footnoteRef" id="fnref3"><sup>3</sup></a></p>
<p>An important point is that you only have one vote at a time — initially your first preference. If your current vote doesn’t count anymore (we’ll get to that) then it transfers to your next preference.</p>
<p>One advantage of this is when candidates withdraw. There were several cases in 2016 of people running for both mayor and council ward, or council ward and community board — if they win the former then they are <a href="http://www.legislation.govt.nz/act/public/2001/0035/latest/DLM94710.html">automatically withdrawn</a> from the latter. In areas using FPP, their votes in the latter race are wasted.<a href="#fn4" class="footnoteRef" id="fnref4"><sup>4</sup></a> In areas using STV, the election is no different to if they had not been on the ballot paper.<a href="#fn5" class="footnoteRef" id="fnref5"><sup>5</sup></a></p>
</div>
<div id="counting" class="section level2">
<h2>Counting</h2>
<p>What happens after the initial first preferences are tallied is an interesting question with many answers. STV is actually a family of voting systems, and there are a variety of methods for determining quotas, excluding candidates and transferring votes. A <a href="https://en.wikipedia.org/wiki/Counting_single_transferable_votes">Wikipedia article provides a reasonable summary</a>. The systems used in Scotland, Ireland, Australia and New Zealand (and elsewhere) all differ slightly.</p>
<p>In New Zealand we use a system devised by <a href="http://www.votingmatters.org.uk/ISSUE1/P1.HTM">Meek in 1969</a> and enshrined in the <a href="http://www.legislation.govt.nz/act/public/2001/0035/latest/DLM93435.html">Local Electoral Act 2001</a>.</p>
<div id="single-seat" class="section level3">
<h3>Single Seat</h3>
<p>For a single seat election, STV is also known as Instant-Runoff Voting (IRV) and Preferential Voting. Simply, a candidate needs to get 50% of the votes to win — if no candidate has enough votes then the lowest polling candidates are eliminated, transferring their votes to the next preferences. Candidates are eliminated until somebody reaches the 50% quota / threshold.</p>
<div id="example-palmerston-north-city-council-mayor-2016" class="section level4">
<h4>Example: Palmerston North City Council, Mayor 2016</h4>
<p>The 2016 mayoralty race in Palmerston North is a simple example of an election being determined on first preferences, giving exactly the same result as FPP. Incumbant mayor Grant Smith received 18,773 votes (94.8%) and was elected on the first iteration, having exceeded the 50% quota of 9,899 votes. <a href="http://www.stuff.co.nz/manawatu-standard/news/83124328/mayoral-contest-in-palmerston-north-to-cost-30000">Convicted child assaulter</a> Ross Barber received only 1,024 votes (5.2%).</p>
<p><img src="images/stv/stv2016_pncc_mayor.png" /></p>
</div>
<div id="example-wellington-regional-council-kapiti-coast-2016" class="section level4">
<h4>Example: Wellington Regional Council, Kapiti Coast 2016</h4>
<p>In 2016, the Kapiti Coast constituency of the Wellington Regional Council had three candidates vying for one seat. 16,455 valid ballots were returned, so the initial quota to be elected was <code>16455 / 2 = 8227.5</code>.</p>
<p>First preferences were distributed among Penny Gaylor (6,736 / 40.9%), Nigel Wilson (6,704 / 40.7%) and Peter Bollmann (3,015 / 18.3%). Since nobody reached the quota Bollmann, the lowest candidate, was excluded and his votes transferred to their next preferences.</p>
<p>Of those that preferred Bollmann, 1,010 next preferred Gaylor and 687 preferred Wilson. Additionally, 1,318 didn’t rank anyone else at all so their votes are set aside. Now the quota is half of the remaining votes, i.e. <code>(16455 - 1318) / 2 = 7568.5</code>. Gaylor now has 7,746 votes so is elected. Wilson is excluded as the seat has been filled.</p>
<p>Here is the same information in an animated chart. You’ll see that I’ve split each iteration into three steps to make it a little clearer — assigning the votes, calculating the quota, and making a decision on what to do next.</p>
<p><img src="images/stv/stv2016_wrc_kapiti.gif" alt="animated bar graph of 2016 Wellington Regional Council Kapiti Coast Constituency STV election results" /></p>
</div>
<div id="example-wellington-city-council-mayor-2016" class="section level4">
<h4>Example: Wellington City Council, Mayor 2016</h4>
<p>The 2016 election for Wellington Mayor featured eight hopeful candidates. This was a longer but still simple election. The order of the candidates never changes from first preference, with winner Justin Lester rising from 36.5% of first preferences to 56.4% going head-to-head against runner up Nick Leggett.</p>
<p>Interestingly, in the 7th and final iteration 8,434 voters (13.0%) ranked neither of the top two candidates (and up to 66.0% of those had voted only for the third place getter Jo Coughlan).</p>
<div id="wcc_mayor_2016">
<p><img src="images/stv/placeholder_stv2016_wcc_mayor.png" alt="Placeholder for 5.1MB animated graph. Click to load with JavaScript" /></p>
</div>
<script>
$(function(){
    $("#wcc_mayor_2016 img").click(function(e){
        $(this).attr("src", "images/stv/stv2016_wcc_mayor.gif");
        $(this).attr("alt", "animated bar graph of 2016 Wellington City Council Mayor STV election")
        return false;
    });
});
</script>
</div>
<div id="example-wellington-city-council-mayor-2010" class="section level4">
<h4>Example: Wellington City Council, Mayor 2010</h4>
<p>The same election six years previous provides an interesting example of the difference that STV can make.</p>
<p>In the first iteration, incumbant two-term mayor Kerry Prendergast led challenger Celia Wade-Brown 21,809 votes (40.9%) to 18,560 votes (34.8%). In the fifth iteration, Wade-Brown finally pipped Prendergast to win 24,881 votes (50.2%) to 24,705 (49.8%).</p>
<p>Prendergast, who came to power under FPP<a href="#fn6" class="footnoteRef" id="fnref6"><sup>6</sup></a> and won a second term under STV, <a href="http://www.stuff.co.nz/dominion-post/news/4225729/STV-system-may-cost-me-election-says-Prendergast">claimed this result was “undemocratic”</a>. I disagree. I read the first preference votes not that “more voters prefer Prendergast to any other candidate”, but that “3/5th of voters would rather have someone other than Prendergast”. Running the STV iterations allows us to discover that more voters preferred Wade-Brown to Prendergast, so her election is the most democratic outcome (given the low voter turnout).</p>
<div id="wcc_mayor_2010">
<p><img src="images/stv/placeholder_stv2010_wcc_mayor.png" alt="Placeholder for 3.5MB animated graph. Click to load with JavaScript" /></p>
</div>
<script>
$(function(){
    $("#wcc_mayor_2010 img").click(function(e){
        $(this).attr("src", "images/stv/stv2010_wcc_mayor.gif");
        $(this).attr("alt", "animated bar graph of 2010 Wellington City Council Mayor STV election")
        return false;
    });
});
</script>
</div>
</div>
<div id="multiple-seats" class="section level3">
<h3>Multiple Seats</h3>
<p>STV elections for multiple seats work similarly to a single seat in that first preference votes are used initially, and the lowest polling candidate is excluded and their votes are transferred to the next preference (if any). The quota that has to be reached in order to be elected is the number of votes divided by one plus the number of seats. So if there are two seats you need one third of the votes, for three seats you need one quarter, and so on.</p>
<p>The main difference is what to do with the votes of candidates who are elected when there are still unfilled seats. In the Meek system, the elected candidate keeps just enough votes to stay over the threshold, and their “surplus” votes are transferred to the subsequent preferences. Importantly (and perhaps confusingly), the surplus votes are transferred proportionately based on the subsequent preferences of <em>all</em> votes for the candidate, so there are likely to be fractional votes from this point.</p>
<div id="example-wellington-regional-council-porirua-tawa-2016" class="section level4">
<h4>Example: Wellington Regional Council, Porirua-Tawa 2016</h4>
<p>Moving south from the Kapiti Coast, the Porirua-Tawa constituency had four candidates vying for two seats on the Wellington Regional Council in 2016. On first preferences, Jenny Brash has 7,705 (45%) of the 17,003 votes, easily surpassing the quota of <code>17003 / 3 = 5667.7</code>. Trailing behind are Barbara Donaldson with 4,649 votes (27.3%), Joern Scherzer with 2,709 votes (15.9%), and Heidi Mills with 1,940 votes (11.4%).</p>
<p>Now Brash has 2,037.3 surplus votes she “doesn’t need”, as they are above the quota, and which can be transferred to the other candidates.</p>
<p>Of the 7,705 people who preferred Brash, 3,728 people (48.4%) next preferred Donaldson, 1,013 people (13.1%) preferred Scherzer, 1,129 (14.7%) preferred Mills, and 1,835 people (23.8%) had ranked nobody else.</p>
<table>
<thead>
<tr class="header">
<th align="left">First Pref</th>
<th align="left">Second Pref</th>
<th align="left">Third Pref</th>
<th align="left">Voters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Brash</td>
<td align="left">Donaldson</td>
<td align="left">?</td>
<td align="left">3,728</td>
</tr>
<tr class="even">
<td align="left">Brash</td>
<td align="left">Scherzer</td>
<td align="left">?</td>
<td align="left">1,013</td>
</tr>
<tr class="odd">
<td align="left">Brash</td>
<td align="left">Mills</td>
<td align="left">?</td>
<td align="left">1,129</td>
</tr>
<tr class="even">
<td align="left">Brash</td>
<td align="left">—</td>
<td align="left">—</td>
<td align="left">1,835</td>
</tr>
<tr class="odd">
<td align="left">Donaldson</td>
<td align="left">?</td>
<td align="left">?</td>
<td align="left">4,649</td>
</tr>
<tr class="even">
<td align="left">Scherzer</td>
<td align="left">?</td>
<td align="left">?</td>
<td align="left">2,709</td>
</tr>
<tr class="odd">
<td align="left">Mills</td>
<td align="left">?</td>
<td align="left">?</td>
<td align="left">1,940</td>
</tr>
</tbody>
</table>
<p>Thus, in the second iteration, Donaldson now has 5,634.7 votes — her original 4,649 first preference votes and 48.4% (985.7) of Brash’s 2,037.3 surplus votes. Since 485.2 votes (23.8% of 2,037.3) have been removed from Brash and not transferred to anyone else, the quota now drops to <code>(17003 - 485.2) / 3 = 5505.9</code>. Donaldson’s votes exceed the quota, so she is elected.</p>
<p>Here is an animation of the calculations.</p>
<p><img src="images/stv/stv2016_wrc_porirua-tawa.gif" alt="animated bar graph of 2016 Wellington Regional Council Porirua-Tawa constituancy STV election" /></p>
<p>Note that if there had been a third seat in contention, the next action would not have been to exclude the lowest polling candidate but again to transfer surplus votes. Donaldson has 128.8 surplus votes, but Brash also has 161.8 surplus votes, as the quota has reduced since the original surplus was calculated. Brash would transfer a few more votes to Donaldson, but it is likely that Donaldson will also transfer some votes to Brash, as there may have been voters that ranked Donaldson 1st and Brash 2nd. In larger elections these mutual transfers can take several iterations to reach an equilibrium.</p>
</div>
<div id="example-kapiti-coast-district-council-waikanae-community-board-2016" class="section level4">
<h4>Example: Kapiti Coast District Council, Waikanae Community Board 2016</h4>
<p>The 2016 Waikanae Community Board was the result of a strongly contested race between nine candidates for four seats, with a count lasting 11 iterations.</p>
<p>Incumbant and local pharmacist James Westbury is elected in the first iteration, with 1,592 votes (29.9%) easily surpassing the quota of 1064.6 votes.</p>
<p>In the following five iterations, Westbury’s surplus is transferred, and the bottom four candidates are excluded.</p>
<p>In the 7th iteration, Jocelyn Prvanov and Tonchi Begovich both exceed the quota and are elected.</p>
<p>Over the following three iterations the surplus of the three winners is transferred. There is a lot of mutual transfer, perhaps not surprising as they campaigned together.</p>
<p>Finally, at iteration 11, the final seat is decided as Jeremy Seamark narrowly exceeds the quota. Incumbant Eric Gregory is excluded.</p>
<div id="kcdc_waikanae-cb">
<p><img src="images/stv/placeholder_stv2016_kcdc_waikanae_cb.png" alt="Placeholder for 7.8MB animated graph. Click to load with JavaScript" /></p>
</div>
<script>
$(function(){
    $("#kcdc_waikanae-cb img").click(function(e){
        $(this).attr("src", "images/stv/stv2016_kcdc_waikanae_cb.gif");
        $(this).attr("alt", "animated bar graph of 2016 Kapiti District Council STV election for Waikanae Community Board")
        return false;
    });
});
</script>
</div>
</div>
</div>
<div id="iterations" class="section level2">
<h2>Iterations</h2>
<p>I found it interesting to see the variation in length of the counting process for the elections. Some were over in a couple of iterations, others in a couple of dozen. The clear winner was the Dunedin City Council’s At Large election, which took 79 iterations to be decided.</p>
<p>There are no doubt a range of factors that can increase or decrease the number of iterations, but the strongest single variable looks, unsurprisingly, to be the number of candidates standing.</p>
<div id="htmlwidget-7aea4c61a11fbe328216" style="width:672px;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-7aea4c61a11fbe328216">{"x":{"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"title":"Number of Candidates"},"yaxis":{"domain":[0,1],"title":"Number of Iterations"},"title":"2016 NZ Local Body Elections, STV Vote Counting","hovermode":"closest"},"config":{"modeBarButtonsToRemove":["sendDataToCloud"]},"base_url":"https://plot.ly","source":"A","data":[{"x":[4,5,5,14,8,6,7,8,6,5,8,11,43,8,8,11,9,12,7,4,3,8,4,2,28,6,13,10,14,6,3,8,4,5,11,3,6,13,4,5,2,9,28,20,null,20,28,null,17,26,18,15,21,14,null,28,20,null,16,null,15],"y":[2,5,4,17,7,5,6,9,5,2,5,10,79,10,12,29,8,19,6,1,2,9,3,1,61,5,16,9,16,4,2,10,2,4,14,2,5,15,3,3,1,11,34,28,null,24,30,null,21,34,18,17,24,30,null,56,23,null,38,null,25],"type":"scatter","mode":"markers","text":["Marlborough District Council,  Mayor (1 seats)<br />4 candidates took 2 iterations","Marlborough District Council,  Marlborough Sounds Ward (3 seats)<br />5 candidates took 5 iterations","Marlborough District Council,  Wairau-Awatere Ward (3 seats)<br />5 candidates took 4 iterations","Marlborough District Council,  Blenheim Ward (7 seats)<br />14 candidates took 17 iterations","Wellington City Council,  Mayor (1 seats)<br />8 candidates took 7 iterations","Wellington City Council,  Northern Ward (3 seats)<br />6 candidates took 5 iterations","Wellington City Council,  Onslow-Western Ward (3 seats)<br />7 candidates took 6 iterations","Wellington City Council,  Lambton Ward (3 seats)<br />8 candidates took 9 iterations","Wellington City Council,  Eastern Ward (3 seats)<br />6 candidates took 5 iterations","Wellington City Council,  Southern Ward (2 seats)<br />5 candidates took 2 iterations","Wellington City Council,  Makara-Ohariu Community Board (6 seats)<br />8 candidates took 5 iterations","Dunedin City Council,  Mayor (1 seats)<br />11 candidates took 10 iterations","Dunedin City Council,  At Large (14 seats)<br />43 candidates took 79 iterations","Dunedin City Council,  Strath Taieri Community Board (6 seats)<br />8 candidates took 10 iterations","Dunedin City Council,  Waikouaiti Coast Community Board (6 seats)<br />8 candidates took 12 iterations","Dunedin City Council,  Mosgiel-Taieri Community Board (6 seats)<br />11 candidates took 29 iterations","Dunedin City Council,  Saddle Hill Community Board (6 seats)<br />9 candidates took 8 iterations","Dunedin City Council,  West Harbour Community Board (6 seats)<br />12 candidates took 19 iterations","Dunedin City Council,  Otago Peninsula Community Board (6 seats)<br />7 candidates took 6 iterations","Kaipara District Council,  Mayor (1 seats)<br />4 candidates took 1 iterations","Kaipara District Council,  Dargaville Ward (2 seats)<br />3 candidates took 2 iterations","Kaipara District Council,  Otamatea Ward (3 seats)<br />8 candidates took 9 iterations","Kaipara District Council,  West Coast - Central Ward (3 seats)<br />4 candidates took 3 iterations","Palmerston North City Council,  Mayor (1 seats)<br />2 candidates took 1 iterations","Palmerston North City Council,  Council (15 seats)<br />28 candidates took 61 iterations","Porirua City Council,  Mayor (1 seats)<br />6 candidates took 5 iterations","Porirua City Council,  Northern Ward (4 seats)<br />13 candidates took 16 iterations","Porirua City Council,  Western Ward (2 seats)<br />10 candidates took 9 iterations","Porirua City Council,  Eastern Ward (4 seats)<br />14 candidates took 16 iterations","Porirua City Council,  Porirua Community Trust - Ward 1 (4 seats)<br />6 candidates took 4 iterations","Porirua City Council,  Hutt Mana Charitable Trust (1 seats)<br />3 candidates took 2 iterations","Wellington Regional Council,  Lower Hutt Constituency (3 seats)<br />8 candidates took 10 iterations","Wellington Regional Council,  Porirua-Tawa Constituency (2 seats)<br />4 candidates took 2 iterations","Wellington Regional Council,  Wairarapa Constituency (1 seats)<br />5 candidates took 4 iterations","Wellington Regional Council,  Wellington Constituency (5 seats)<br />11 candidates took 14 iterations","Wellington Regional Council,  Kapiti Coast Constituency (1 seats)<br />3 candidates took 2 iterations","Kapiti Coast District Council,  Mayor (1 seats)<br />6 candidates took 5 iterations","Kapiti Coast District Council,  At Large - Districtwide (5 seats)<br />13 candidates took 15 iterations","Kapiti Coast District Council,  Waikanae Ward (1 seats)<br />4 candidates took 3 iterations","Kapiti Coast District Council,  Paraparaumu Ward (2 seats)<br />5 candidates took 3 iterations","Kapiti Coast District Council,  Paekakariki-Raumati Ward (1 seats)<br />2 candidates took 1 iterations","Kapiti Coast District Council,  Waikanae Community Board (4 seats)<br />9 candidates took 11 iterations","Auckland District Health Board (7 seats)<br />28 candidates took 34 iterations","Bay of Plenty District Health Board (7 seats)<br />20 candidates took 28 iterations",null,"Capital & Coast District Health Board (7 seats)<br />20 candidates took 24 iterations","Counties Manukau District Health Board (7 seats)<br />28 candidates took 30 iterations",null,"Hutt Valley District Health Board (7 seats)<br />17 candidates took 21 iterations","Lakes District Health Board (7 seats)<br />26 candidates took 34 iterations","MidCentral District Health Board (7 seats)<br />18 candidates took 18 iterations","Nelson Marlborough District Health Board (7 seats)<br />15 candidates took 17 iterations","Northland District Health Board (7 seats)<br />21 candidates took 24 iterations","South Canterbury District Health Board (7 seats)<br />14 candidates took 30 iterations",null,"Taranaki District Health Board (7 seats)<br />28 candidates took 56 iterations","Waikato District Health Board (7 seats)<br />20 candidates took 23 iterations",null,"Waitemata District Health Board (7 seats)<br />16 candidates took 38 iterations",null,"Whanganui District Health Board (7 seats)<br />15 candidates took 25 iterations"],"hoverinfo":"text","marker":{"size":[10,22.8571428571429,22.8571428571429,48.5714285714286,10,22.8571428571429,22.8571428571429,22.8571428571429,22.8571428571429,16.4285714285714,42.1428571428571,10,93.5714285714286,42.1428571428571,42.1428571428571,42.1428571428571,42.1428571428571,42.1428571428571,42.1428571428571,10,16.4285714285714,22.8571428571429,22.8571428571429,10,100,10,29.2857142857143,16.4285714285714,29.2857142857143,29.2857142857143,10,22.8571428571429,16.4285714285714,10,35.7142857142857,10,10,35.7142857142857,10,16.4285714285714,10,29.2857142857143,48.5714285714286,48.5714285714286,null,48.5714285714286,48.5714285714286,null,48.5714285714286,48.5714285714286,48.5714285714286,48.5714285714286,48.5714285714286,48.5714285714286,null,48.5714285714286,48.5714285714286,null,48.5714285714286,null,48.5714285714286],"sizemode":"area","fillcolor":"rgba(31,119,180,1)","color":"rgba(31,119,180,1)","line":{"color":"transparent"}},"xaxis":"x","yaxis":"y"}]},"evals":[],"jsHooks":[]}</script>
</div>
<div id="post-script" class="section level2">
<h2>Post Script</h2>
<p>I’ve found this an interesting process, both for the insights and the technical experimentation.</p>
<div id="elections-and-officials" class="section level4">
<h4>Elections and Officials</h4>
<p>I’ve always been in favour of using STV for local body elections (but prefer MMP for parliament) and thought I had a good idea of how it works. I’ve discovered though that there was a reasonable amount I was unclear on. Getting closer to grokking how the multi-seat counting works and what the fractional votes mean has been enlightening. I’m still a little uneasy about the fractional votes, and am interested to dig a little deeper, especially to look at the differences between the different STV methods.</p>
<p>Also interesting has been an extension of experiencing, as mentioned in the last post, the variety in different councils’ and DHBs’ approaches to making information available. Six of the eight councils, and one of the nineteen DHBs made the iteration report available on their websites. Only one supplied the original XML used by the voting software; the others used PDF, RTF or XLSX. So I put out several <a href="https://fyi.org.nz/user/david_friggens/requests">OIA/LGOIMA requests</a> for the rest, which similarly elicited a range of responses. One quickly put it up on their website the next day, six have yet to respond, two weeks later. Some passed it through to the 3rd party election company who supplied the XML, others just sent a PDF or Word DOC (not DOCX) and said “that’s all we have!” Finally, two helpfully printed and scanned the datatable (one with a “RELEASED UNDER THE OIA” watermark) to make text extraction impossible. Thankfully they both eventually supplied something more usable.</p>
</div>
<div id="data-and-graphs" class="section level4">
<h4>Data and Graphs</h4>
<p>More mundanely, this post has been in gestation for 2-3 weeks. Partly because I’ve been amassing quite a bit of data from the various elections and trying to make sense of them (including retyping some from unhelpful PDFs). I want to have a broader look across it all, and I think it’s grown a bit too big for the blog, so I plan to start a separate repository for it all.</p>
<p>Also, I attempted to create these graphs in three (3!) different formats — ggplot, Plot.ly and Highcharts. First, I spent a reasonable amount of time figuring out how to make the animated gifs I’ve included in the post, created with <a href="https://github.com/dgrtwo/gganimate">gganimate</a> and <a href="https://github.com/thomasp85/tweenr">tweenr</a> (and I have to give a huge thank you to Len Kiefer’s excellent posts for helping with this.<a href="#fn7" class="footnoteRef" id="fnref7"><sup>7</sup></a>). I really like how these have turned out — they’re pretty close to what I had in mind from the outset. My main complaints are that it would be nice to have some (user) controls over the animation, and the files can get quite large (20-40MB for the DHBs).</p>
<p>I gave a talk on this subject at Toastmasters last week, and redid all of these graphs in <a href="http://plot.ly/r/">Plot.ly</a>. This gave me separate graphs for each of the iterations to step through manually, as well as interactive control to zoom in etc. Later, I tried to see if they could be animated, but the best that seems possible is hiding and revealing different series (i.e. not having smooth transformations between them), and controlling the changes by selecting from a drop-down box rather than having a “play” or “next” button.</p>
<p>Just recently I discovered Highcharts’ <a href="http://jkunst.com/highcharter/plugins.html">motion plugin</a> and have tried to recreate the graphs with this too. I’ve successfully created a static plot, but have struggled with the animation. I’ve decided to give up for now and possibly try again later, though it’s not clear to me from the documentation and examples whether I would be able to animate the quota line as well as the bars.</p>
</div>
<div id="te-be-continued" class="section level4">
<h4>Te be continued…</h4>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>The DHBs are legally mandated to use STV — one of them didn’t have elections this year.<a href="#fnref1">↩</a></p></li>
<li id="fn2"><p>It is theoretically possible to vote “strategically” in STV, but it is NP-complete to determine, so it’s not really something that comes into play. <a href="http://diafaneia.ee.auth.gr/sites/default/files/stv.pdf">(Bartholdi and Orlin, 1990)</a><a href="#fnref2">↩</a></p></li>
<li id="fn3"><p>I trust that concrete evidence exists for all of the things I’ve mentioned in this paragraph, but I’ve only seen them mentioned in discussion and haven’t felt moved to try and track down references for you. Sorry.<a href="#fnref3">↩</a></p></li>
<li id="fn4"><p>For example, in <a href="http://www.waipadc.govt.nz/our-council/Elections/Pages/Results.aspx">Waipa District Council</a>, Sue Milner was elected to the council in the Cambridge Ward. She also stood for the Cambridge Subdivision (a community board), where she was the third highest polling of seven candidates for four seats. This meant that 16.8% of votes cast — alternatively, one of the four votes cast by 67.1% of voters — were wasted. Given that she received 2,722 votes, and the gap between 4th and 7th was 506 votes, it’s quite conceivable that one or two of the candidates elected could have been different if she had not stood.<a href="#fnref4">↩</a></p></li>
<li id="fn5"><p>For example, in <a href="http://www.kapiticoast.govt.nz/Your-Council/The-Role-of-Council/elections2016/">Kapiti Coast District Council</a>, K Gurunathan won the mayoralty so all of the votes cast for him as a Districtwide councillor just passed on to the next preference. There were 490 people (2.8%) who voted for him only so their votes could be seen to be wasted. But considering there were 13 people standing for 5 seats I think we can assume that they thought the others were ratbags and wouldn’t have voted for anyone if “Guru” wasn’t on the ballot. <code>:-)</code><a href="#fnref5">↩</a></p></li>
<li id="fn6"><p>I haven’t located any speculation or data on this, but I recall my feeling at the time being that she would not have won under STV.<a href="#fnref6">↩</a></p></li>
<li id="fn7"><p><a href="http://lenkiefer.com/2016/05/29/improving-R-animated-gifs-with-tweenr">Improving R animated GIFs with tweenr</a> and <a href="http://lenkiefer.com/2016/05/30/more-tweenr-animations">More tweenr animation examples</a><a href="#fnref7">↩</a></p></li>
</ol>
</div>

<hr />

<footer>
<p><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="images/cc.png" /></a><br />This site is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</footer>



</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});


</script>


</body>
</html>
